<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>2024-12-27-中南海改造-第3个建筑 - 记录伟大征程</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="">





    <meta name="description" content="第3栋建筑初始参考是这个后来不知道为什么被我完全推翻按照图2来做了，我的想法是按照图2把图1的里面两个建筑合二为一，但是整体风格好像味道变了。">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-12-27-中南海改造-第3个建筑">
<meta property="og:url" content="http://zhudian.xyz/2025/01/15/2024-12-27/index.html">
<meta property="og:site_name" content="记录伟大征程">
<meta property="og:description" content="第3栋建筑初始参考是这个后来不知道为什么被我完全推翻按照图2来做了，我的想法是按照图2把图1的里面两个建筑合二为一，但是整体风格好像味道变了。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/dc4434c0203cf5c6e24b16645133e86f_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/93119e28e15576d90c519684db4cecab_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/dde8a3fa2f41e0e8b9ee08ce339edb53_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/b9625914718e6d6bd692ff865252ab57_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/4f1cfb9906d4ba29746a0da51fd7c6b1_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/a44ef59250f7b2f9c33fa4dc1d030c87_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/afd5c36df59585e78b4e1f1b435bf880_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/62cd0e460ff088d5eef5ac66f7037cac_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/ee9e478cd1debacdb67ae32f3a43d1cf_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/d2e9d80fc269b0e1701c2cfbc5d7fa24_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/0feae1076736fb9d6b3c6f030b4de58b_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/0ed6e3ca3855bb72206c2ac4be22b1ca_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/958bab0bfffc8350cf7e34f938d8f943_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/2e55fc4037a012991173c95a8c4bbde4_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/21217c489da7a19123e6d7b1fe052d9a_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/e0c39f820bb24ccc63d24e37c872521c_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/75b53ee95b19d0d16e76359f404e20ee_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/e3047cd0f6eecaf1db98a44c1cef9eea_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/2c220792b9b9e02666994b41ca2f6aea_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/48a7b5759a9ed134aa5bdae456cde646_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/4797cbb97e902078c682947fdb03c376_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/eb77c92373486acf54b3bfe838588200_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/036079884481f2ee8e198648632ba506_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/ebf7716f98e5be1c063d358c25efc9cc_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/52073a7a8cf853083539210e68f7fa98_MD5.jpg">
<meta property="og:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/2c672fa61c541de840352c185863c8e1_MD5.jpg">
<meta property="article:published_time" content="2025-01-15T01:30:10.000Z">
<meta property="article:modified_time" content="2025-01-15T02:14:22.191Z">
<meta property="article:author" content="于洋">
<meta property="article:tag" content="midjourney">
<meta property="article:tag" content="设计探索">
<meta property="article:tag" content="python">
<meta property="article:tag" content="浮雕彩绘">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zhudian.xyz/2025/01/15/2024-12-27/2024-12-27/dc4434c0203cf5c6e24b16645133e86f_MD5.jpg">





<link rel="icon" href="/favicon.ico">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    

    


<meta name="generator" content="Hexo 6.0.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    <img src="/long3.jpg" alt="" height="28">
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">归档</a>
            
            <a class="navbar-item "
               href="/categories/%E5%BB%BA%E7%AD%91%E7%90%86%E8%AE%BA">建筑理论</a>
            
            <a class="navbar-item "
               href="/categories/CG%E6%8A%80%E6%9C%AF">CG技术</a>
            
            <a class="navbar-item "
               href="/categories/%E6%97%A5%E8%AE%B0">日记</a>
            
            <a class="navbar-item "
               href="/about">我的目标</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜索" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目录">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                </div>
            </div>
            
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            2024-12-27-中南海改造-第3个建筑
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2025-01-15T01:30:10.000Z" itemprop="datePublished">1月 15 2025</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/%E6%97%A5%E8%AE%B0/">日记</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            25 分钟 读完 (约 3716 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><p>第3栋建筑初始参考是这个后来不知道为什么被我完全推翻按照图2来做了，我的想法是按照图2把图1的里面两个建筑合二为一，但是整体风格好像味道变了。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/dc4434c0203cf5c6e24b16645133e86f_MD5.jpg"></p>
<span id="more"></span>

<p><img src="/2025/01/15/2024-12-27/2024-12-27/93119e28e15576d90c519684db4cecab_MD5.jpg"></p>
<p>为了让转角连接上我做了环绕柱廊，折边黑墙。立柱方面用相交圆做了层叠再分段选循环面法线挤出然后旋转复制夹1个立方体，柱头成功测试了复杂雕花用curve deform变形吸附柱头，不过这个方法只能对垂直方向一体化拉伸的柱头，对于科林斯这种有上下缩进的还没测试，感觉上可以用lattice来调整局部缩放。再是duplicate along curve添加了cornice下面的滴水式雕花。二楼的拱门上镶金是提取曲线后给厚度转换mesh而成的，这个技巧很实用，对强调边缘立体的装饰能轻松解决。一楼隐约看是两个窗格，我在大门的间距上没处理好这个比例看起来有问题，或者说问题出在了整体的长宽设置就不合理？相对于原图而言我拉长了很多，但没有额外配套的房型，这样显得黑色折叠墙十分单调。其实这涉及另一个问题就是当给定地块后，只是参考设计效果图，并不好照搬，涉及比例问题尽管可以用midjourney生产相似，持续抽到比例合适的，但这么做有些耗时，有时候自己想当然就动手“微调”结果样式、部件到位了却因为比例问题整体上看还是不满意。图2我改了下比例明显感觉好点了，到时候看情况是不是要调整。</p>
<p>房型单一的问题或许可以通过imagine extend 图片参考建筑类型来解决，比如8 storey 12 storey hotel building facade.抽空测试下。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/dde8a3fa2f41e0e8b9ee08ce339edb53_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/b9625914718e6d6bd692ff865252ab57_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/4f1cfb9906d4ba29746a0da51fd7c6b1_MD5.jpg"></p>
<p>圆拱门是否可以做出带有中国色彩的建筑？从这个角度看这套的柱廊上方可以做出类似太和殿的结构从而保留中式风格，看起来和开间大小有关系，门拱不能尖或完全圆需要“磨平一些，两侧可以模拟中式柱头的那个翼型托梁。</p>
<p>以上是最初的版本，我感觉太单调了，且缺乏创新说辞。在与黄色航天飞机墙布多次blend尝试进一步与黑金建筑blend我得到了天地玄黄式建筑的初版。这样看来天地玄黄来自于黄色调背景与太空飞船的硬表面细节，这样误打误撞生产了金字书法于黑色圆柱、木板上的装饰技法，理解这一点意味着天地玄黄可以往太空主题发展，其立意将更进一步。</p>
<p>天地玄黄是古代中国人对天地宇宙最初始状态的一种认知与思索，“玄”：本义是黑色，有深远、高深莫测的意味，用来形容天的那种幽远深邃、神秘难测的特质。“黄”：本意是指黄色，用以描述大地的颜色和一种承载万物的厚重、质朴之感。据记载我国夏商周时期以黑为尊，后世则以黄为贵，以玄黄体现中华元素的建筑装饰体系过往是没有的。</p>
<p>在制作这套时我遇到了电脑意外卡屏，黑屏无法显示的问题，似乎是主板上什么线松动了，我插了一插又好了，不过过程中我并没有感到哪里松，傅文辉说是pcie线松了。总之好了之后再次打开，修改packed a texture转换virutual texture第一次卡了很久。另外window interior材质扩展添加不同贴图第一次也会卡很久。</p>
<p>多保存，反复退出重进，避免那个update texture streaming卡死白做！！！</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/a44ef59250f7b2f9c33fa4dc1d030c87_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/afd5c36df59585e78b4e1f1b435bf880_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/62cd0e460ff088d5eef5ac66f7037cac_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/ee9e478cd1debacdb67ae32f3a43d1cf_MD5.jpg"></p>
<p>在认准了一个建筑装饰亮点后，通过它的blend原料可以生产其装饰特征的同分异构体，然后ps拼接出房型。这个案例中的拼接十分简单仅仅是现成的叠成3层，之前我过度依赖midjourney，以为可以通过它直接生产整体，现在看来这是不现实的，通过imaine extend就可以看出来对于人类世界未知的无法用文字准确描述的装饰特征，midjourney无法再现，因此只有图和图blend使其丧失逻辑的情况下可能产生创意，而创意出现后需要人为组织修正。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/d2e9d80fc269b0e1701c2cfbc5d7fa24_MD5.jpg"></p>
<p>bakemaster自动smart unwrap对于许多部件看起来效果不好尤其是超长cornice。折腾了一天很多复杂部件的matrix材质效果不理想，最后还是整体smart unwrap解决，原理不明，为什么批量smart unwrap时出现问题了呢？</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/0feae1076736fb9d6b3c6f030b4de58b_MD5.jpg"></p>
<p>一开始我把这个黑金阵列理解为金色浮雕板阵列嵌在黑木板上</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/0ed6e3ca3855bb72206c2ac4be22b1ca_MD5.jpg"></p>
<p>然而这样的浮雕效果不好，感觉应该是带有大片空隙的木雕能透出更多黑色木板，但这样要搞很多几何体。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/958bab0bfffc8350cf7e34f938d8f943_MD5.jpg"></p>
<p>我后来改成了整面的平板金字书法，技法是matrix材质直接改albedo贴图，效果看起来可以，为了保证接缝问题，需要midjourney生产–tile，为适应不同规格么，需要大批量的–ar。1楼的盾纹花雕是几何体duplicate along curve因为几何体面数太大，所以没法combine楼上的简易盾纹则combine，几何体数量太多导入时会占用很长时间，据说几何体数量太多对性能也有影响。</p>
<p>叠涩斗拱上的浮雕使其质感有一定提升但是还达不到想象中要做的冠冕立柱。黑黄相间可以突出天地玄黄的概念。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/2e55fc4037a012991173c95a8c4bbde4_MD5.jpg"></p>
<p>整版黑底金字书法用一个url引导imagine extend可以得到各种规格的效果，说明对于简单特征的图片midjourney imagine extend可以把我较为准确。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/21217c489da7a19123e6d7b1fe052d9a_MD5.jpg"></p>
<p>酒杯柱头立柱柱身加入了浮雕，其做法和书法一样也是利用修改matrix材质不过还需要把normal也改了，为此我让deepseek写了一个python程序可以批量把图片改为1024x1024平铺，以及另一个程序可以使图片直接转换为normal贴图，实测效果非常棒，酒杯柱头上用的matrix材质改normal。可以说在这个案例中我把浮雕雕塑的运用进一步提升熟练了，理论上实现了浮雕有间隙的情况下雕在不同颜色的其他材质上，如镀金金属雕塑雕在黑木板上。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/e0c39f820bb24ccc63d24e37c872521c_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/75b53ee95b19d0d16e76359f404e20ee_MD5.jpg"></p>
<p>cornice上用浮雕平铺效果也是不错的</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/e3047cd0f6eecaf1db98a44c1cef9eea_MD5.jpg"></p>
<p>屋顶我采用duplicate along curve马头柱加回纹不规则排布的护栏形式作为屋脊，一开始我想的是聚拢的三重屋脊，但中间那道想不到用什么搞。马头雕塑来源于midjourney生产后切分图片给aiuni生产3d模型。这个管道我用的圆柱体拼一段段拼接，并没有用curve，curve有时候gizmo会找不到导致移动不方便，不过感觉还是得用curve，圆柱的话不好转折，得多次复制。我一开始用的curve，不停调整不同的圆柱直径，感觉效果不好，非常的混乱改为相同直径之后好多了，不过整体效果还是不理想。另外顶楼的柱体以及多联窗框是偏红的，抽空修改一下，看看是不是能提升效果，现在好像黄色太多了些。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/2c220792b9b9e02666994b41ca2f6aea_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/48a7b5759a9ed134aa5bdae456cde646_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/4797cbb97e902078c682947fdb03c376_MD5.jpg"></p>
<p>天地玄黄式建筑可以说是我的第一个创新式可拓展建筑装饰语言体系，我打算继续在第5栋建筑上使用并延伸这个体系。</p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/eb77c92373486acf54b3bfe838588200_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/036079884481f2ee8e198648632ba506_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/ebf7716f98e5be1c063d358c25efc9cc_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/52073a7a8cf853083539210e68f7fa98_MD5.jpg"></p>
<p><img src="/2025/01/15/2024-12-27/2024-12-27/2c672fa61c541de840352c185863c8e1_MD5.jpg"></p>
<figure class="highlight python hljs"><figcaption><span>autotile1024自动批量将目标图片以1024x1024尺寸平铺</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> os</span><br><span class="line"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">tile_image_to_1024</span>(<span class="hljs-params">img, output_path</span>):</span><br><span class="line">    <span class="hljs-string">"""将单张图片平铺为1024x1024大小并保存"""</span></span><br><span class="line">    img_width, img_height = img.size</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 计算缩放比例</span></span><br><span class="line">    <span class="hljs-keyword">if</span> img_width &gt; img_height:</span><br><span class="line">        <span class="hljs-comment"># 图片是横向的，以宽度为基准缩放</span></span><br><span class="line">        scale = <span class="hljs-number">1024</span> / img_width</span><br><span class="line">        tile_width = <span class="hljs-number">1024</span></span><br><span class="line">        tile_height = <span class="hljs-built_in">int</span>(img_height * scale)</span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        <span class="hljs-comment"># 图片是纵向的，以高度为基准缩放</span></span><br><span class="line">        scale = <span class="hljs-number">1024</span> / img_height</span><br><span class="line">        tile_height = <span class="hljs-number">1024</span></span><br><span class="line">        tile_width = <span class="hljs-built_in">int</span>(img_width * scale)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 缩放图片</span></span><br><span class="line">    img_resized = img.resize((tile_width, tile_height), Image.Resampling.LANCZOS)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 创建1024x1024的画布</span></span><br><span class="line">    canvas = Image.new(<span class="hljs-string">'RGB'</span>, (<span class="hljs-number">1024</span>, <span class="hljs-number">1024</span>))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 计算平铺次数</span></span><br><span class="line">    x_tiles = <span class="hljs-number">1024</span> // tile_width</span><br><span class="line">    y_tiles = <span class="hljs-number">1024</span> // tile_height</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 平铺图片</span></span><br><span class="line">    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(y_tiles + <span class="hljs-number">1</span>):  <span class="hljs-comment"># +1 确保覆盖边缘</span></span><br><span class="line">        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x_tiles + <span class="hljs-number">1</span>):  <span class="hljs-comment"># +1 确保覆盖边缘</span></span><br><span class="line">            <span class="hljs-comment"># 计算粘贴位置</span></span><br><span class="line">            paste_x = x * tile_width</span><br><span class="line">            paste_y = y * tile_height</span><br><span class="line">            <span class="hljs-comment"># 将图片粘贴到画布上</span></span><br><span class="line">            canvas.paste(img_resized, (paste_x, paste_y))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 保存生成的图片</span></span><br><span class="line">    canvas.save(output_path)</span><br><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"图片已平铺并保存到: <span class="hljs-subst">{output_path}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">process_folder</span>(<span class="hljs-params">input_folder, output_folder</span>):</span><br><span class="line">    <span class="hljs-string">"""处理指定文件夹下的所有图片"""</span></span><br><span class="line">    <span class="hljs-comment"># 确保输出文件夹存在</span></span><br><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(output_folder):</span><br><span class="line">        os.makedirs(output_folder)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 遍历文件夹中的所有文件</span></span><br><span class="line">    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(input_folder):</span><br><span class="line">        file_path = os.path.join(input_folder, filename)</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment"># 检查文件是否为图片</span></span><br><span class="line">        <span class="hljs-keyword">if</span> filename.lower().endswith((<span class="hljs-string">'.png'</span>, <span class="hljs-string">'.jpg'</span>, <span class="hljs-string">'.jpeg'</span>, <span class="hljs-string">'.bmp'</span>, <span class="hljs-string">'.gif'</span>, <span class="hljs-string">'.tiff'</span>)):</span><br><span class="line">            <span class="hljs-keyword">try</span>:</span><br><span class="line">                <span class="hljs-comment"># 打开图片</span></span><br><span class="line">                <span class="hljs-keyword">with</span> Image.<span class="hljs-built_in">open</span>(file_path) <span class="hljs-keyword">as</span> img:</span><br><span class="line">                    <span class="hljs-comment"># 生成输出路径</span></span><br><span class="line">                    output_path = os.path.join(output_folder, filename)</span><br><span class="line">                    <span class="hljs-comment"># 平铺图片并保存</span></span><br><span class="line">                    tile_image_to_1024(img, output_path)</span><br><span class="line">            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:</span><br><span class="line">                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"处理文件 <span class="hljs-subst">{filename}</span> 时出错: <span class="hljs-subst">{e}</span>"</span>)</span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"跳过非图片文件: <span class="hljs-subst">{filename}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 示例调用</span></span><br><span class="line">input_folder = <span class="hljs-string">r"F:\SendToUE练习\中式酒樽高脚园林式布局\tile"</span>  <span class="hljs-comment"># 输入文件夹路径</span></span><br><span class="line">output_folder = <span class="hljs-string">r"F:\SendToUE练习\中式酒樽高脚园林式布局\tile\output"</span>  <span class="hljs-comment"># 输出文件夹路径</span></span><br><span class="line">process_folder(input_folder, output_folder)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python hljs"><figcaption><span>pictonormal自动批量将图片转换为1024x1024的normal贴图，若尺寸不足1024则以黑色填充剩余部分再转换</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> os</span><br><span class="line"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image</span><br><span class="line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">resize_to_1024</span>(<span class="hljs-params">image, target_size=(<span class="hljs-params"><span class="hljs-number">1024</span>, <span class="hljs-number">1024</span></span>)</span>):</span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    将输入图像调整为 1024x1024 尺寸。</span></span><br><span class="line"><span class="hljs-string">    图像会等比例缩放，不足部分用黑色填充。</span></span><br><span class="line"><span class="hljs-string">    </span></span><br><span class="line"><span class="hljs-string">    :param image: 输入的 PIL 图像</span></span><br><span class="line"><span class="hljs-string">    :param target_size: 目标尺寸，默认为 (1024, 1024)</span></span><br><span class="line"><span class="hljs-string">    :return: 调整后的 PIL 图像</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-comment"># 获取原始尺寸</span></span><br><span class="line">    original_width, original_height = image.size</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 计算等比例缩放尺寸</span></span><br><span class="line">    scale_factor = <span class="hljs-built_in">min</span>(target_size[<span class="hljs-number">0</span>] / original_width, target_size[<span class="hljs-number">1</span>] / original_height)</span><br><span class="line">    new_width = <span class="hljs-built_in">int</span>(original_width * scale_factor)</span><br><span class="line">    new_height = <span class="hljs-built_in">int</span>(original_height * scale_factor)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 缩放图像</span></span><br><span class="line">    resized_image = image.resize((new_width, new_height), Image.Resampling.LANCZOS)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 创建目标尺寸的画布并填充黑色</span></span><br><span class="line">    padded_image = Image.new(<span class="hljs-string">'RGB'</span>, target_size, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 计算粘贴位置，使图像居中</span></span><br><span class="line">    offset_x = (target_size[<span class="hljs-number">0</span>] - new_width) // <span class="hljs-number">2</span></span><br><span class="line">    offset_y = (target_size[<span class="hljs-number">1</span>] - new_height) // <span class="hljs-number">2</span></span><br><span class="line">    padded_image.paste(resized_image, (offset_x, offset_y))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> padded_image</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">grayscale_to_normal_map</span>(<span class="hljs-params">image, strength=<span class="hljs-number">5.0</span></span>):</span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    将灰度图像转换为法线贴图。</span></span><br><span class="line"><span class="hljs-string">    </span></span><br><span class="line"><span class="hljs-string">    :param image: 输入的 PIL 图像（灰度图）</span></span><br><span class="line"><span class="hljs-string">    :param strength: 法线贴图的强度，默认为 5.0</span></span><br><span class="line"><span class="hljs-string">    :return: 生成的法线贴图（PIL 图像）</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    pixels = np.array(image, dtype=np.float32) / <span class="hljs-number">255.0</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 使用 Sobel 算子计算梯度</span></span><br><span class="line">    kernel_x = np.array([[-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],</span><br><span class="line">                         [-<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>],</span><br><span class="line">                         [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]], dtype=np.float32)</span><br><span class="line">    kernel_y = np.array([[-<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>],</span><br><span class="line">                         [ <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>],</span><br><span class="line">                         [ <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">1</span>]], dtype=np.float32)</span><br><span class="line"></span><br><span class="line">    gradient_x = np.zeros_like(pixels)</span><br><span class="line">    gradient_y = np.zeros_like(pixels)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 对图像进行卷积，计算梯度</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, pixels.shape[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>):</span><br><span class="line">        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, pixels.shape[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>):</span><br><span class="line">            gradient_x[i, j] = np.<span class="hljs-built_in">sum</span>(pixels[i-<span class="hljs-number">1</span>:i+<span class="hljs-number">2</span>, j-<span class="hljs-number">1</span>:j+<span class="hljs-number">2</span>] * kernel_x)</span><br><span class="line">            gradient_y[i, j] = np.<span class="hljs-built_in">sum</span>(pixels[i-<span class="hljs-number">1</span>:i+<span class="hljs-number">2</span>, j-<span class="hljs-number">1</span>:j+<span class="hljs-number">2</span>] * kernel_y)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 归一化梯度</span></span><br><span class="line">    normal_map = np.zeros((pixels.shape[<span class="hljs-number">0</span>], pixels.shape[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>), dtype=np.float32)</span><br><span class="line">    normal_map[..., <span class="hljs-number">0</span>] = gradient_x * strength  <span class="hljs-comment"># R 通道</span></span><br><span class="line">    normal_map[..., <span class="hljs-number">1</span>] = gradient_y * strength  <span class="hljs-comment"># G 通道</span></span><br><span class="line">    normal_map[..., <span class="hljs-number">2</span>] = <span class="hljs-number">1.0</span>                   <span class="hljs-comment"># B 通道</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 归一化法线向量</span></span><br><span class="line">    norm = np.sqrt(normal_map[..., <span class="hljs-number">0</span>]**<span class="hljs-number">2</span> + normal_map[..., <span class="hljs-number">1</span>]**<span class="hljs-number">2</span> + normal_map[..., <span class="hljs-number">2</span>]**<span class="hljs-number">2</span>)</span><br><span class="line">    normal_map[..., <span class="hljs-number">0</span>] /= norm</span><br><span class="line">    normal_map[..., <span class="hljs-number">1</span>] /= norm</span><br><span class="line">    normal_map[..., <span class="hljs-number">2</span>] /= norm</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 将法线向量从 [-1, 1] 映射到 [0, 255]</span></span><br><span class="line">    normal_map = (normal_map + <span class="hljs-number">1.0</span>) * <span class="hljs-number">127.5</span></span><br><span class="line">    normal_map = np.clip(normal_map, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>).astype(np.uint8)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> Image.fromarray(normal_map, <span class="hljs-string">'RGB'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">process_image</span>(<span class="hljs-params">image_path, output_path, strength=<span class="hljs-number">5.0</span></span>):</span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    处理单张图像：</span></span><br><span class="line"><span class="hljs-string">    1. 调整尺寸为 1024x1024。</span></span><br><span class="line"><span class="hljs-string">    2. 转换为法线贴图。</span></span><br><span class="line"><span class="hljs-string">    3. 保存结果。</span></span><br><span class="line"><span class="hljs-string">    </span></span><br><span class="line"><span class="hljs-string">    :param image_path: 输入图像的路径</span></span><br><span class="line"><span class="hljs-string">    :param output_path: 输出图像的路径</span></span><br><span class="line"><span class="hljs-string">    :param strength: 法线贴图的强度，默认为 5.0</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-comment"># 打开图像</span></span><br><span class="line">    image = Image.<span class="hljs-built_in">open</span>(image_path)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 调整尺寸为 1024x1024</span></span><br><span class="line">    resized_image = resize_to_1024(image)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 转换为灰度图</span></span><br><span class="line">    grayscale_image = resized_image.convert(<span class="hljs-string">'L'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 转换为法线贴图</span></span><br><span class="line">    normal_map = grayscale_to_normal_map(grayscale_image, strength=strength)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 保存结果</span></span><br><span class="line">    normal_map.save(output_path)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">def</span> <span class="title function_">process_folder</span>(<span class="hljs-params">input_folder, output_folder, strength=<span class="hljs-number">5.0</span></span>):</span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    处理指定文件夹下的所有图片：</span></span><br><span class="line"><span class="hljs-string">    1. 调整尺寸为 1024x1024。</span></span><br><span class="line"><span class="hljs-string">    2. 转换为法线贴图。</span></span><br><span class="line"><span class="hljs-string">    3. 保存结果到输出文件夹。</span></span><br><span class="line"><span class="hljs-string">    </span></span><br><span class="line"><span class="hljs-string">    :param input_folder: 输入文件夹路径</span></span><br><span class="line"><span class="hljs-string">    :param output_folder: 输出文件夹路径</span></span><br><span class="line"><span class="hljs-string">    :param strength: 法线贴图的强度，默认为 5.0</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-comment"># 确保输出文件夹存在</span></span><br><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(output_folder):</span><br><span class="line">        os.makedirs(output_folder)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 遍历输入文件夹中的所有文件</span></span><br><span class="line">    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(input_folder):</span><br><span class="line">        <span class="hljs-comment"># 检查文件是否为图片（支持常见格式）</span></span><br><span class="line">        <span class="hljs-keyword">if</span> filename.lower().endswith((<span class="hljs-string">'.png'</span>, <span class="hljs-string">'.jpg'</span>, <span class="hljs-string">'.jpeg'</span>, <span class="hljs-string">'.bmp'</span>, <span class="hljs-string">'.tiff'</span>)):</span><br><span class="line">            input_path = os.path.join(input_folder, filename)</span><br><span class="line">            output_path = os.path.join(output_folder, filename)</span><br><span class="line"></span><br><span class="line">            <span class="hljs-comment"># 处理图片</span></span><br><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Processing: <span class="hljs-subst">{filename}</span>'</span>)</span><br><span class="line">            <span class="hljs-keyword">try</span>:</span><br><span class="line">                process_image(input_path, output_path, strength=strength)</span><br><span class="line">                <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Saved: <span class="hljs-subst">{output_path}</span>'</span>)</span><br><span class="line">            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:</span><br><span class="line">                <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Error processing <span class="hljs-subst">{filename}</span>: <span class="hljs-subst">{e}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 使用示例</span></span><br><span class="line">input_folder = <span class="hljs-string">r'F:\SendToUE练习\中式酒樽高脚园林式布局\fudiaotu'</span></span><br><span class="line">output_folder = <span class="hljs-string">r'F:\SendToUE练习\中式酒樽高脚园林式布局\fudiao2'</span></span><br><span class="line">process_folder(input_folder, output_folder, strength=<span class="hljs-number">5.0</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/midjourney/">#midjourney</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/">#设计探索</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/python/">#python</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/%E6%B5%AE%E9%9B%95%E5%BD%A9%E7%BB%98/">#浮雕彩绘</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop is-hidden-mobile article-nav-prev">
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2025/01/15/2024-12-25/">2024-12-25-中南海改造-第2个建筑</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">评论</h3>
    
<div id="valine-thread"></div>

<style>
.v[data-class="v"] .veditor {
    max-height: 17em;
    overflow-y: scroll;
}

/* 去除查看更多 */
.v[data-class="v"] .vcards .vcard .vcontent.expand {
    max-height: none;
}

.v[data-class="v"] .vcards .vcard .vcontent.expand::before,
.v[data-class="v"] .vcards .vcard .vcontent.expand::after {
    display: none;
}

</style>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdn.jsdelivr.net/gh/flatblowfish/cave-draw/dist/cave-draw.min.js"></script>

<script>
    new Valine({
        el: '#valine-thread',
        appId: 'iPPfF8Jwk6zoVuC8yAJLVdLT-gzGzoHsz',
        appKey: 'D78M0CStPxwTiqW2ql4mmhrA',
        notify: false,
        verify: false,
        avatar: 'mp',
        placeholder: '想到什么说什么',
        meta: ['nick', 'mail'],
        visitor: true,
        lang: 'zh-CN'
    })

var count = 0;
var dom_timer = setInterval(function () {
	if (++count > 50) clearInterval(dom_timer);
	if (document.querySelector('#veditor')) {
		var cdraw = new CaveDraw({
			element: "#veditor",
			readOnlyMode: false, // valine 不提交form，而是过滤评论框数据后发送，所以评论框不能readonly。
			afterUpdateEditor: ()=>{ // 手动触发valine对评论框数据的过滤
				document.querySelector('#veditor').focus();
				document.querySelector('#veditor').blur();
			},
			controls: ['brush', 'eraser', 'bucket', 'clear', 'undo', 'redo', 'save']
		});
		clearInterval(dom_timer);
	}
}, 200);
</script>


</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 于洋&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery > p > .gallery-item').unwrap();
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索" />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>